---
/**
 * CTASection Component
 * Dark CTA section with headline, subtitle, and buttons.
 * Premium monochromatic design.
 */

import Section from '@/components/ui/Section.astro';
import Container from '@/components/ui/Container.astro';
import Button from '@/components/ui/Button.astro';

interface CTAButton {
  text: string;
  href: string;
  variant?: 'primary' | 'secondary' | 'outline';
}

interface Props {
  headline: string;
  headlineAccent?: string;
  subtitle?: string;
  primaryButton: CTAButton;
  secondaryButton?: CTAButton;
  trustBadges?: string[];
  class?: string;
}

const {
  headline,
  headlineAccent,
  subtitle,
  primaryButton,
  secondaryButton,
  trustBadges,
  class: className = '',
} = Astro.props;

// Parse headline to find accent word
const renderHeadline = () => {
  if (headlineAccent && headline.toLowerCase().includes(headlineAccent.toLowerCase())) {
    const regex = new RegExp(`(${headlineAccent})`, 'gi');
    const parts = headline.split(regex);
    return parts.map((part) =>
      part.toLowerCase() === headlineAccent.toLowerCase()
        ? `<span class="italic text-white/40">${part}</span>`
        : part
    ).join('');
  }
  return headline;
};
---

<Section background="dark" class={`relative overflow-hidden py-24 ${className}`}>
  <Container>
    <div class="relative max-w-5xl mx-auto text-center">
      <!-- Headline -->
      <h2
        class="text-3xl md:text-6xl font-semibold text-white mb-10 tracking-tight leading-tight"
        set:html={renderHeadline()}
      />

      <!-- Subtitle -->
      {subtitle && (
        <p class="text-lg md:text-xl text-white/50 mb-14 max-w-2xl mx-auto leading-relaxed">
          {subtitle}
        </p>
      )}

      <!-- Buttons -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <Button
          href={primaryButton.href}
          variant="accent"
          size="lg"
          class="bg-white text-black hover:bg-gray-100 border-none px-12 font-bold tracking-widest text-xs uppercase"
        >
          {primaryButton.text}
        </Button>

        {secondaryButton && (
          <Button
            href={secondaryButton.href}
            variant="outline"
            size="lg"
            class="px-12 border-white/20 hover:bg-white/5 text-white font-semibold"
          >
            {secondaryButton.text}
          </Button>
        )}
      </div>

      <!-- Trust Badges -->
      {trustBadges && trustBadges.length > 0 && (
        <div class="flex items-center justify-center gap-12 mt-20 pt-10 border-t border-white/10">
          {trustBadges.map((badge) => (
            <span class="text-[10px] uppercase tracking-[0.3em] font-bold text-white/30">
              {badge}
            </span>
          ))}
        </div>
      )}
    </div>
  </Container>
</Section>
